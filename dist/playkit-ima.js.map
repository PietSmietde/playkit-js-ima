{"version":3,"sources":["./ima/webpack/universalModuleDefinition","./ima/webpack/bootstrap a0e64c4e75c8792be47b","./ima/./state.js","./ima/./ima.js","./ima/external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}","./ima/./ima-middleware.js","./ima/./ima-state-machine.js","./ima/../node_modules/javascript-state-machine/lib/state-machine.js","./ima/../node_modules/javascript-state-machine/lib/history.js"],"names":["State","LOADING","LOADED","PLAYING","PAUSED","IDLE","DONE","pluginName","ADS_CONTAINER_ID","Ima","name","player","config","_stateMachine","_initMembers","_addBindings","_init","adTagUrl","logger","warn","debug","_adsManager","getAdSkippableState","skip","skipSupport","stop","_nextPromise","Object","defer","resume","pause","eventManager","removeAll","_stopAdInterval","_hideAdsContainer","destroy","_adsLoader","_contentComplete","contentComplete","_initAdsLoader","_requestAds","loaded","goto","_adDisplayContainer","initialize","_hasUserAction","_isAdsManagerLoaded","_startAdsManager","adError","error","playerViewSize","_getPlayerViewSize","init","width","height","_sdk","ViewMode","NORMAL","start","forEach","listen","document","fullScreenEvent","_resizeAd","bind","window","Event","VOLUME_CHANGE","_syncPlayerVolume","SOURCE_SELECTED","event","selectedSource","payload","length","_contentSrc","url","_setTogglePlayPauseOnAdsContainerEnabled","_setContentPlayheadTrackerEventsEnabled","_setVideoEndedCallbackEnabled","_currentAd","_intervalTimer","_videoLastCurrentTime","_contentPlayheadTracker","currentTime","previousTime","seeking","duration","_togglePlayPauseOnAdsContainerCallback","loadPromise","_isImaSDKLibLoaded","Promise","resolve","Dom","loadScriptAsync","IMA_SDK_DEBUG_LIB_URL","IMA_SDK_LIB_URL","then","google","ima","VERSION","_initImaSettings","_initAdsContainer","catch","e","reject","settings","setPlayerType","playerName","setPlayerVersion","playerVersion","setVpaidAllowed","setVpaidMode","ImaSdkSettings","VpaidMode","ENABLED","adsContainerDiv","getElementById","playerView","getView","_adsContainerDiv","createElement","id","style","position","top","appendChild","AdDisplayContainer","getVideoElement","AdsLoader","addEventListener","AdsManagerLoadedEvent","Type","ADS_MANAGER_LOADED","_onAdsManagerLoaded","AdErrorEvent","AD_ERROR","aderror","adEvent","adsResponse","adsRequest","AdsRequest","linearAdSlotWidth","linearAdSlotHeight","nonLinearAdSlotWidth","nonLinearAdSlotHeight","requestAds","isFullScreen","_isFullScreen","viewMode","FULLSCREEN","resize","fullscreenElement","Boolean","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","parseInt","getComputedStyle","enabled","LOADED_METADATA","_onLoadedMetadata","TIME_UPDATE","_onMediaTimeUpdate","SEEKING","_onMediaSeeking","SEEKED","_onMediaSeeked","unlisten","enable","ENDED","_onMediaEnded","isCustomPlaybackUsed","isLinear","display","adsManagerLoadedEvent","adsRenderingSettings","AdsRenderingSettings","keys","setting","getAdsManager","_attachAdsManagerListeners","AdEvent","CONTENT_PAUSE_REQUESTED","adbreakstart","adloaded","STARTED","adstarted","adpaused","RESUMED","adresumed","FIRST_QUARTILE","adfirstquartile","MIDPOINT","admidpoint","THIRD_QUARTILE","adthirdquartile","CLICK","adclicked","SKIPPED","adskipped","COMPLETE","adcompleted","CONTENT_RESUME_REQUESTED","adbreakend","ALL_ADS_COMPLETED","alladscompleted","USER_CLOSE","userclosedad","VOLUME_CHANGED","advolumechanged","VOLUME_MUTED","admuted","LOG","muted","setVolume","volume","setInterval","is","remainingTime","getRemainingTime","getCurrentAd","getDuration","Number","isNumber","dispatchEvent","AD_PROGRESS","adProgress","clearInterval","removeEventListener","paused","play","companions","googletag","companionsIds","i","sizeCriteria","companionAds","selectionCriteria","CompanionAdSelectionSettings","resourceType","ResourceType","ALL","creativeType","CreativeType","toLowerCase","SizeCriteria","SELECT_NEAR_MATCH","IGNORE","SELECT_EXACT_MATCH","getCompanionAds","companionAd","content","getContent","el","innerHTML","defaultConfig","restoreCustomPlaybackStateOnAdBreakComplete","enablePreloading","useStyledLinearAds","useStyledNonLinearAds","bitrate","autoAlign","ImaMiddleware","context","_context","CHANGE_SOURCE_STARTED","_isPlayerLoaded","next","load","sm","getStateMachine","state","initialUserAction","callNext","resumeAd","pauseAd","ImaStateMachine","transitions","from","to","AD_STARTED","ad","getAd","AD_RESUMED","AD_PAUSED","AD_SKIPPED","AD_COMPLETED","AD_BREAK_END","AD_LOADED","AD_FIRST_QUARTILE","AD_BREAK_START","AD_MIDPOINT","AD_THIRD_QUARTILE","USER_CLOSED_AD","AD_VOLUME_CHANGED","AD_MUTED","AD_CLICKED","s","methods","onAdloaded","onAdLoaded","onAdstarted","onAdStarted","onAdpaused","onAdPaused","onAdresumed","onAdEvent","onAdclicked","onAdClicked","onAdskipped","onAdSkipped","onAdcompleted","onAdCompleted","onAlladscompleted","onAllAdsCompleted","onAdbreakstart","onAdBreakStart","onAdbreakend","onAdBreakEnd","onAdfirstquartile","onAdmidpoint","onAdthirdquartile","onAderror","onAdError","onUserclosedad","onAdvolumechanged","onAdmuted","onEnterState","plugins","options","type","toUpperCase","transition","normalizeAdEvent","_showAdsContainer","_maybeDisplayCompanionAds","_onAdsContainerClicked","_resolveNextPromise","_startAdInterval","call","src","_maybeSaveVideoCurrentTime","_maybeSetVideoCurrentTime","getError","normalizeAdError","adData","getAdData","getMessage","fatal","code","getErrorCode","message","extraAdData"],"mappings":"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;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B,EAAE;AAC/D,yCAAyC,eAAe;AACxD;AACA;AACA;AACA;AACA;AACA,8DAA8D,+DAA+D;AAC7H;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA,aAAa,uBAAuB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,qCAAqC,UAAU;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;;AAEA,qCAAqC,UAAU;AAC/C;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,aAAa,mBAAmB;AAChC;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;;AAGA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,iBAAiB,mCAAmC;AACpD,iBAAiB,mCAAmC;AACpD,iBAAiB,mCAAmC;AACpD,iBAAiB,mCAAmC;AACpD,iBAAiB;AACjB;AACA,GAAG;;AAEH;AACA;AACA,wCAAwC,uBAAuB,yBAAyB;AACxF;AACA;AACA,wCAAwC,6BAA6B,eAAe;AACpF;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,yBAAyB,aAAa;AACtC;AACA,yBAAyB,WAAW;AACpC,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,qCAAqC,UAAU;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC,4BAA4B,+CAA+C;AAC3E;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA,CAAC;;AAED;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,6BAA6B;;AAE7B;;AAEA,kBAAkB;AAClB;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH,qCAAqC,qBAAqB,kBAAkB;AAC5E,qCAAqC,sBAAsB,eAAe,EAAE;AAC5E,qCAAqC,sBAAsB,cAAc,GAAG;AAC5E,qCAAqC,2BAA2B,YAAY;;AAE5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH,sCAAsC;AACtC;AACA,UAAU,UAAU;AACpB;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA,CAAC;;AAED;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,8CAA8C,iEAAiE;AAC/G,8CAA8C,iEAAiE;AAC/G,8CAA8C,iEAAiE;AAC/G,8CAA8C,iEAAiE;AAC/G,8CAA8C,iEAAiE;AAC/G,8CAA8C,iEAAiE;AAC/G,8CAA8C,iEAAiE;AAC/G,8CAA8C,iEAAiE;AAC/G,8CAA8C,iEAAiE;AAC/G;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,yBAAyB;AACzB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;AACP;AACA,CAAC,E;;;;;;AC5pBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,cAAc;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B,EAAE;AAC/D,yCAAyC,eAAe;AACxD;AACA;AACA;AACA;AACA;AACA,8DAA8D,+DAA+D;AAC7H;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,aAAa,mBAAmB;AAChC;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA,oCAAoC;;AAEpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,kBAAkB;AAClB;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;AACP;AACA,CAAC,E","file":"playkit-ima.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"playkit-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"playkit-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PlaykitJsIma\"] = factory(require(\"playkit-js\"));\n\telse\n\t\troot[\"PlaykitJsIma\"] = factory(root[\"Playkit\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a0e64c4e75c8792be47b","// @flow\n\n/**\n * The ima plugin possible states.\n * @type {Object}\n */\nconst State: { [state: string]: string } = {\n  LOADING: \"loading\",\n  LOADED: \"loaded\",\n  PLAYING: \"playing\",\n  PAUSED: \"paused\",\n  IDLE: \"idle\",\n  DONE: \"done\"\n};\n\nexport default State;\n\n\n\n// WEBPACK FOOTER //\n// ./state.js","// @flow\nimport ImaMiddleware from './ima-middleware'\nimport ImaStateMachine from './ima-state-machine'\nimport State from './state'\nimport {registerPlugin, BasePlugin} from 'playkit-js'\nimport {BaseMiddleware} from 'playkit-js'\nimport {Utils} from 'playkit-js'\n\n/**\n * The plugin name.\n * @type {string}\n * @const\n */\nconst pluginName: string = \"ima\";\n/**\n * The ads container id.\n * @type {string}\n * @const\n */\nconst ADS_CONTAINER_ID: string = \"playkit-ads-container\";\n\n/**\n * The ima plugin.\n * @classdesc\n */\nexport default class Ima extends BasePlugin {\n\n  /**\n   * The default configuration of the plugin.\n   * @type {Object}\n   * @static\n   */\n  static defaultConfig: Object = {\n    debug: false,\n    companions: {},\n    adsRenderingSettings: {\n      restoreCustomPlaybackStateOnAdBreakComplete: true,\n      enablePreloading: false,\n      useStyledLinearAds: false,\n      useStyledNonLinearAds: true,\n      bitrate: -1,\n      autoAlign: true\n    }\n  };\n\n  /**\n   * The sdk lib url.\n   * @type {string}\n   * @static\n   */\n  static IMA_SDK_LIB_URL: string = \"//imasdk.googleapis.com/js/sdkloader/ima3.js\";\n  /**\n   * The debug sdk lib url.\n   * @type {string}\n   * @static\n   */\n  static IMA_SDK_DEBUG_LIB_URL: string = \"//imasdk.googleapis.com/js/sdkloader/ima3_debug.js\";\n  /**\n   * Promise for loading the plugin.\n   * Will be resolved after:\n   * 1) Ima script has been loaded in the page.\n   * 2) The ads manager has been loaded and ready to start.\n   * @type {Promise<*>}\n   * @member\n   * @public\n   */\n  loadPromise: DeferredPromise;\n  /**\n   * The finite state machine of the plugin.\n   * @member\n   * @private\n   */\n  _stateMachine: any;\n  /**\n   * The sdk api.\n   * @member\n   * @private\n   */\n  _sdk: any;\n  /**\n   * The ads container dom element.\n   * @member\n   * @private\n   */\n  _adsContainerDiv: HTMLElement;\n  /**\n   * The ima ads container object.\n   */\n  _adDisplayContainer: any;\n  /**\n   * The ima ads manager.\n   * @member\n   * @private\n   */\n  _adsManager: any;\n  /**\n   * The ima ads loader.\n   * @member\n   * @private\n   */\n  _adsLoader: any;\n  /**\n   * The content tracker.\n   * @member\n   * @private\n   */\n  _contentPlayheadTracker: Object;\n  /**\n   * Flag to know when content complete.\n   * @member\n   * @private\n   */\n  _contentComplete: boolean;\n  /**\n   * The ad interval timer.\n   * @member\n   * @private\n   */\n  _intervalTimer: ?number;\n  /**\n   * Video current time before ads.\n   * On custom playback when only one video tag playing, save the video current time.\n   * @member\n   * @private\n   */\n  _videoLastCurrentTime: ?number;\n  /**\n   * The promise which when resolved starts the next handler in the middleware chain.\n   * @member\n   * @private\n   */\n  _nextPromise: ?DeferredPromise;\n  /**\n   * The current playing ad.\n   * @member\n   * @private\n   */\n  _currentAd: any;\n  /**\n   * The content media src.\n   * @member\n   * @private\n   */\n  _contentSrc: string;\n  /**\n   * Whether an initial user action happened.\n   * @member\n   * @private\n   */\n  _hasUserAction: boolean;\n  /**\n   * Whether the ads manager loaded.\n   * @member\n   * @private\n   */\n  _isAdsManagerLoaded: boolean;\n  /**\n   * The bounded handler of the ads container click.\n   * @member\n   * @private\n   */\n  _togglePlayPauseOnAdsContainerCallback: ?Function;\n\n  /**\n   * Whether the ima plugin is valid.\n   * @static\n   * @override\n   * @public\n   */\n  static isValid() {\n    return true;\n  }\n\n  /**\n   * @constructor\n   * @param {string} name - The plugin name.\n   * @param {Player} player - The player instance.\n   * @param {Object} config - The plugin config.\n   */\n  constructor(name: string, player: Player, config: Object) {\n    super(name, player, config);\n    this._stateMachine = new ImaStateMachine(this);\n    this._initMembers();\n    this._addBindings();\n    this._init();\n  }\n\n  /**\n   * TODO: Rethink on design and implementation.\n   * Plays ad on demand.\n   * @param {string} adTagUrl - The ad tag url to play.\n   * @returns {void}\n   */\n  playAdNow(adTagUrl: string): void {\n    this.logger.warn(\"playAdNow API is not implemented yet\", adTagUrl);\n  }\n\n  /**\n   * Skips on an ad.\n   * @returns {void}\n   */\n  skipAd(): void {\n    this.logger.debug(\"Skip ad\");\n    if (this._adsManager) {\n      if (this._adsManager.getAdSkippableState()) {\n        this._adsManager.skip();\n      } else if (this.config.skipSupport) {\n        this._adsManager.stop();\n      }\n    }\n  }\n\n  /**\n   * Resuming the ad.\n   * @public\n   * @returns {DeferredPromise} - The promise which when resolved starts the next handler in the middleware chain.\n   */\n  resumeAd(): ?DeferredPromise {\n    this.logger.debug(\"Resume ad\");\n    this._nextPromise = Utils.Object.defer();\n    this._adsManager.resume();\n    return this._nextPromise;\n  }\n\n  /**\n   * Pausing the ad.\n   * @public\n   * @returns {DeferredPromise} - The promise which when resolved starts the next handler in the middleware chain.\n   */\n  pauseAd(): ?DeferredPromise {\n    this.logger.debug(\"Pause ad\");\n    this._nextPromise = Utils.Object.defer();\n    this._adsManager.pause();\n    return this._nextPromise;\n  }\n\n  /**\n   * Gets the state machine.\n   * @public\n   * @returns {any} - The state machine.\n   */\n  getStateMachine(): any {\n    return this._stateMachine;\n  }\n\n  /**\n   * Gets the middleware.\n   * @public\n   * @returns {ImaMiddleware} - The middleware api.\n   */\n  getMiddlewareImpl(): BaseMiddleware {\n    return new ImaMiddleware(this);\n  }\n\n  /**\n   * Resets the plugin.\n   * @override\n   * @public\n   * @returns {void}\n   */\n  reset(): void {\n    this.logger.debug(\"reset\");\n    this.eventManager.removeAll();\n    this._stopAdInterval();\n    this._hideAdsContainer();\n    if (this._adsManager) {\n      this._adsManager.destroy();\n    }\n    if (this._adsLoader && !this._contentComplete) {\n      this._adsLoader.contentComplete();\n    }\n    this._initMembers();\n    this._addBindings();\n    if (!this._adsLoader) {\n      this._initAdsLoader();\n    }\n    this._requestAds();\n    if (this.config.adTagUrl) {\n      this._stateMachine.loaded();\n    } else {\n      this._stateMachine.goto(State.DONE);\n    }\n  }\n\n  /**\n   * Destroys the plugin.\n   * @override\n   * @public\n   * @returns {void}\n   */\n  destroy(): void {\n    this.logger.debug(\"destroy\");\n    this.eventManager.destroy();\n    this._stopAdInterval();\n    this._hideAdsContainer();\n    if (this._adsManager) {\n      this._adsManager.destroy();\n    }\n    if (this._adsLoader && !this._contentComplete) {\n      this._adsLoader.contentComplete();\n    }\n    this._adsLoader = null;\n    this._initMembers();\n  }\n\n  /**\n   * Initialize the ads for the first time.\n   * @public\n   * @returns {?DeferredPromise} - The promise which when resolved starts the next handler in the middleware chain.\n   */\n  initialUserAction(): ?DeferredPromise {\n    try {\n      this.logger.debug(\"Initial user action\");\n      this._nextPromise = Utils.Object.defer();\n      this._adDisplayContainer.initialize();\n      this._hasUserAction = true;\n      if (this._isAdsManagerLoaded) {\n        this.logger.debug(\"User action occurred after ads manager loaded\");\n        this._startAdsManager();\n      }\n    } catch (adError) {\n      this.logger.error(adError);\n      this.destroy();\n    }\n    return this._nextPromise;\n  }\n\n  /**\n   * Starts the ads manager.\n   * @private\n   * @returns {void}\n   */\n  _startAdsManager(): void {\n    let playerViewSize = this._getPlayerViewSize();\n    this.logger.debug(\"Start ads manager\");\n    this._adsManager.init(playerViewSize.width, playerViewSize.height, this._sdk.ViewMode.NORMAL);\n    this._adsManager.start();\n  }\n\n  /**\n   * Adding bindings.\n   * @private_addBindings\n   * @returns {void}\n   */\n  _addBindings(): void {\n    [\n      'fullscreenchange',\n      'mozfullscreenchange',\n      'webkitfullscreenchange'\n    ].forEach(fullScreenEvent => this.eventManager.listen(document, fullScreenEvent, this._resizeAd.bind(this)));\n    this.eventManager.listen(window, 'resize', this._resizeAd.bind(this));\n    this.eventManager.listen(this.player, this.player.Event.VOLUME_CHANGE, this._syncPlayerVolume.bind(this));\n    this.eventManager.listen(this.player, this.player.Event.SOURCE_SELECTED, (event) => {\n      let selectedSource = event.payload.selectedSource;\n      if (selectedSource && selectedSource.length > 0) {\n        this._contentSrc = selectedSource[0].url;\n      }\n    });\n  }\n\n  /**\n   * Init the members of the plugin.\n   * @private\n   * @returns {void}\n   */\n  _initMembers(): void {\n    this._setTogglePlayPauseOnAdsContainerEnabled(false);\n    this._setContentPlayheadTrackerEventsEnabled(false);\n    this._setVideoEndedCallbackEnabled(false);\n    this._nextPromise = null;\n    this._currentAd = null;\n    this._adsManager = null;\n    this._contentComplete = false;\n    this._isAdsManagerLoaded = false;\n    this._intervalTimer = null;\n    this._videoLastCurrentTime = null;\n    this._contentPlayheadTracker = {currentTime: 0, previousTime: 0, seeking: false, duration: 0};\n    this._hasUserAction = false;\n    this._togglePlayPauseOnAdsContainerCallback = null;\n  }\n\n  /**\n   * Initializing the plugin.\n   * @private\n   * @returns {void}\n   */\n  _init(): void {\n    this.loadPromise = Utils.Object.defer();\n    (this._isImaSDKLibLoaded()\n      ? Promise.resolve()\n      : Utils.Dom.loadScriptAsync(this.config.debug ? Ima.IMA_SDK_DEBUG_LIB_URL : Ima.IMA_SDK_LIB_URL))\n      .then(() => {\n        this._sdk = window.google.ima;\n        this.logger.debug(\"IMA SDK version: \" + this._sdk.VERSION);\n        this._initImaSettings();\n        this._initAdsContainer();\n        this._initAdsLoader();\n        this._requestAds();\n        this._stateMachine.loaded();\n        this.loadPromise.resolve();\n      })\n      .catch((e) => {\n        this.loadPromise.reject(e);\n      });\n  }\n\n  /**\n   * Checks for ima sdk lib availability.\n   * @returns {boolean} - Whether ima sdk lib is loaded.\n   * @private\n   */\n  _isImaSDKLibLoaded(): boolean {\n    return (window.google && window.google.ima && window.google.ima.VERSION);\n  }\n\n  /**\n   * Init ima settings.\n   * @private\n   * @returns {void}\n   */\n  _initImaSettings(): void {\n    this._sdk.settings.setPlayerType(this.config.playerName);\n    this._sdk.settings.setPlayerVersion(this.config.playerVersion);\n    this._sdk.settings.setVpaidAllowed(true);\n    this._sdk.settings.setVpaidMode(this._sdk.ImaSdkSettings.VpaidMode.ENABLED);\n  }\n\n  /**\n   * Initializing the ad container.\n   * @private\n   * @returns {void}\n   */\n  _initAdsContainer(): void {\n    this.logger.debug(\"Init ads container\");\n    let adsContainerDiv = Utils.Dom.getElementById(ADS_CONTAINER_ID);\n    if (!adsContainerDiv) {\n      let playerView = this.player.getView();\n      this._adsContainerDiv = Utils.Dom.createElement('div');\n      this._adsContainerDiv.id = ADS_CONTAINER_ID + playerView.id;\n      this._adsContainerDiv.style.position = \"absolute\";\n      this._adsContainerDiv.style.top = \"0px\";\n      Utils.Dom.appendChild(playerView, this._adsContainerDiv);\n    } else {\n      this._adsContainerDiv = adsContainerDiv;\n    }\n    this._adDisplayContainer = new this._sdk.AdDisplayContainer(this._adsContainerDiv, this.player.getVideoElement());\n  }\n\n  /**\n   * Initializing the ads loader.\n   * @private\n   * @returns {void}\n   */\n  _initAdsLoader(): void {\n    this.logger.debug(\"Init ads loader\");\n    this._adsLoader = new this._sdk.AdsLoader(this._adDisplayContainer);\n    this._adsLoader.addEventListener(this._sdk.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, this._onAdsManagerLoaded.bind(this));\n    this._adsLoader.addEventListener(this._sdk.AdErrorEvent.Type.AD_ERROR, adEvent => this._stateMachine.aderror(adEvent));\n  }\n\n  /**\n   * Requests the ads from the ads loader.\n   * @private\n   * @returns {void}\n   */\n  _requestAds(): void {\n    if (this.config.adTagUrl || this.config.adsResponse) {\n      this.logger.debug(\"Request ads\");\n      // Request video ads\n      let adsRequest = new this._sdk.AdsRequest();\n      if (this.config.adTagUrl) {\n        adsRequest.adTagUrl = this.config.adTagUrl;\n      } else {\n        adsRequest.adsResponse = this.config.adsResponse;\n      }\n      let playerViewSize = this._getPlayerViewSize();\n      adsRequest.linearAdSlotWidth = playerViewSize.width;\n      adsRequest.linearAdSlotHeight = playerViewSize.height;\n      adsRequest.nonLinearAdSlotWidth = playerViewSize.width;\n      adsRequest.nonLinearAdSlotHeight = playerViewSize.height / 3;\n      this._adsLoader.requestAds(adsRequest);\n    } else {\n      this.logger.warn(\"Missing ad tag url: create plugin without requesting ads\");\n    }\n  }\n\n  /**\n   * Resize event handler.\n   * @private\n   * @returns {void}\n   */\n  _resizeAd() {\n    if (this._sdk && this._adsManager) {\n      let playerViewSize = this._getPlayerViewSize();\n      let isFullScreen = this._isFullScreen();\n      let viewMode = (isFullScreen ? this._sdk.ViewMode.FULLSCREEN : this._sdk.ViewMode.NORMAL);\n      this._adsManager.resize(playerViewSize.width, playerViewSize.height, viewMode);\n    }\n  }\n\n  /**\n   * Helper for checking if the document is in full screen mode.\n   * @private\n   * @returns {boolean} - Whether the document is in full screen mode.\n   */\n  _isFullScreen(): boolean {\n    return typeof document.fullscreenElement !== 'undefined' && Boolean(document.fullscreenElement) ||\n      typeof document.webkitFullscreenElement !== 'undefined' && Boolean(document.webkitFullscreenElement) ||\n      typeof document.mozFullScreenElement !== 'undefined' && Boolean(document.mozFullScreenElement) ||\n      typeof document.msFullscreenElement !== 'undefined' && Boolean(document.msFullscreenElement);\n  }\n\n  /**\n   * Gets the player view width and height.\n   * @return {Object} - The player sizes.\n   * @private\n   */\n  _getPlayerViewSize(): Object {\n    let playerView = this.player.getView();\n    let width = parseInt(getComputedStyle(playerView).width, 10);\n    let height = parseInt(getComputedStyle(playerView).height, 10);\n    return {width: width, height: height};\n  }\n\n  /**\n   * Loadedmetada event handler.\n   * @private\n   * @returns {void}\n   */\n  _onLoadedMetadata(): void {\n    this._contentPlayheadTracker.duration = this.player.duration;\n  }\n\n  /**\n   * Timeupdate event handler.\n   * @private\n   * @returns {void}\n   */\n  _onMediaTimeUpdate(): void {\n    if (!this._contentPlayheadTracker.seeking) {\n      this._contentPlayheadTracker.previousTime = this._contentPlayheadTracker.currentTime;\n      this._contentPlayheadTracker.currentTime = this.player.currentTime;\n    }\n  }\n\n  /**\n   * Sets the content playhead tracker events enabled/disabled.\n   * @param {boolean} enabled - Whether do enabled the events.\n   * @private\n   * @returns {void}\n   */\n  _setContentPlayheadTrackerEventsEnabled(enabled: boolean): void {\n    if (enabled) {\n      this.eventManager.listen(this.player, this.player.Event.LOADED_METADATA, this._onLoadedMetadata.bind(this));\n      this.eventManager.listen(this.player, this.player.Event.TIME_UPDATE, this._onMediaTimeUpdate.bind(this));\n      this.eventManager.listen(this.player, this.player.Event.SEEKING, this._onMediaSeeking.bind(this));\n      this.eventManager.listen(this.player, this.player.Event.SEEKED, this._onMediaSeeked.bind(this));\n    } else {\n      this.eventManager.unlisten(this.player, this.player.Event.LOADED_METADATA);\n      this.eventManager.unlisten(this.player, this.player.Event.TIME_UPDATE);\n      this.eventManager.unlisten(this.player, this.player.Event.SEEKING);\n      this.eventManager.unlisten(this.player, this.player.Event.SEEKED);\n    }\n  }\n\n  /**\n   * Seeking event handler.\n   * @private\n   * @returns {void}\n   */\n  _onMediaSeeking(): void {\n    this._contentPlayheadTracker.seeking = true;\n  }\n\n  /**\n   * Seeked event handler.\n   * @private\n   * @returns {void}\n   */\n  _onMediaSeeked(): void {\n    this._contentPlayheadTracker.seeking = false;\n  }\n\n  /**\n   * Removes or adds the listener for ended event.\n   * @param {boolean} enable - Whether to enable the event listener or not.\n   * @private\n   * @return {void}\n   */\n  _setVideoEndedCallbackEnabled(enable: boolean): void {\n    if (enable) {\n      this.eventManager.listen(this.player, this.player.Event.ENDED, this._onMediaEnded.bind(this));\n    } else {\n      this.eventManager.unlisten(this.player, this.player.Event.ENDED);\n    }\n  }\n\n  /**\n   * Maybe save the video current time before ads starts (on ios this is necessary).\n   * @private\n   * @return {void}\n   */\n  _maybeSaveVideoCurrentTime(): void {\n    if (this._adsManager.isCustomPlaybackUsed() && this.player.currentTime && this.player.currentTime > 0) {\n      this.logger.debug(\"Custom playback used: save current time before ads\", this.player.currentTime);\n      this._videoLastCurrentTime = this.player.currentTime;\n    }\n  }\n\n  /**\n   * Maybe sets the video current time after ads finished (on ios this is necessary).\n   * @private\n   * @return {void}\n   */\n  _maybeSetVideoCurrentTime(): void {\n    if (this._videoLastCurrentTime) {\n      this.logger.debug(\"Custom playback used: set current time after ads\", this._videoLastCurrentTime);\n      this.player.currentTime = this._videoLastCurrentTime;\n      this._videoLastCurrentTime = null;\n    }\n  }\n\n  /**\n   * Ended event handler.\n   * @private\n   * @returns {void}\n   */\n  _onMediaEnded(): void {\n    this.logger.debug(\"Media ended\");\n    this._adsLoader.contentComplete();\n    this._contentComplete = true;\n    if (!this._currentAd.isLinear()) {\n      this.destroy();\n    }\n  }\n\n  /**\n   * Shows the ads container.\n   * @private\n   * @returns {void}\n   */\n  _showAdsContainer(): void {\n    if (this._adsContainerDiv) {\n      this._adsContainerDiv.style.display = \"\";\n    }\n  }\n\n  /**\n   * Hides the ads container.\n   * @private\n   * @returns {void}\n   */\n  _hideAdsContainer(): void {\n    if (this._adsContainerDiv) {\n      this._adsContainerDiv.style.display = \"none\";\n    }\n  }\n\n  /**\n   * The ads manager loaded handler.\n   * @param {any} adsManagerLoadedEvent - The event data.\n   * @private\n   * @returns {void}\n   */\n  _onAdsManagerLoaded(adsManagerLoadedEvent: any): void {\n    this.logger.debug('Ads manager loaded');\n    let adsRenderingSettings = new this._sdk.AdsRenderingSettings();\n    Object.keys(this.config.adsRenderingSettings).forEach((setting) => {\n      if (adsRenderingSettings[setting] != null) {\n        adsRenderingSettings[setting] = this.config.adsRenderingSettings[setting];\n      }\n    });\n    this._adsManager = adsManagerLoadedEvent.getAdsManager(this._contentPlayheadTracker, adsRenderingSettings);\n    this._isAdsManagerLoaded = true;\n    this._attachAdsManagerListeners();\n    this._syncPlayerVolume();\n    if (this._hasUserAction) {\n      this.logger.debug(\"User action occurred before ads manager loaded\");\n      this._startAdsManager();\n    }\n  }\n\n  /**\n   * Attach the ads manager listeners.\n   * @private\n   * @returns {void}\n   */\n  _attachAdsManagerListeners(): void {\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.CONTENT_PAUSE_REQUESTED, adEvent => this._stateMachine.adbreakstart(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.LOADED, adEvent => this._stateMachine.adloaded(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.STARTED, adEvent => this._stateMachine.adstarted(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.PAUSED, adEvent => this._stateMachine.adpaused(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.RESUMED, adEvent => this._stateMachine.adresumed(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.FIRST_QUARTILE, adEvent => this._stateMachine.adfirstquartile(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.MIDPOINT, adEvent => this._stateMachine.admidpoint(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.THIRD_QUARTILE, adEvent => this._stateMachine.adthirdquartile(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.CLICK, adEvent => this._stateMachine.adclicked(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.SKIPPED, adEvent => this._stateMachine.adskipped(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.COMPLETE, adEvent => this._stateMachine.adcompleted(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.CONTENT_RESUME_REQUESTED, adEvent => this._stateMachine.adbreakend(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.ALL_ADS_COMPLETED, adEvent => this._stateMachine.alladscompleted(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.USER_CLOSE, adEvent => this._stateMachine.userclosedad(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.VOLUME_CHANGED, adEvent => this._stateMachine.advolumechanged(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.VOLUME_MUTED, adEvent => this._stateMachine.admuted(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.LOG, adEvent => this._stateMachine.aderror(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdErrorEvent.Type.AD_ERROR, adEvent => this._stateMachine.aderror(adEvent));\n  }\n\n  /**\n   * Syncs the player volume.\n   * @private\n   * @returns {void}\n   */\n  _syncPlayerVolume(): void {\n    if (this._adsManager) {\n      if (this.player.muted) {\n        this._adsManager.setVolume(0);\n      } else {\n        this._adsManager.setVolume(this.player.volume);\n      }\n    }\n  }\n\n  /**\n   * Starts ad interval timer.\n   * @private\n   * @returns {void}\n   */\n  _startAdInterval(): void {\n    this._stopAdInterval();\n    this._intervalTimer = setInterval(() => {\n      if (this._stateMachine.is(State.PLAYING)) {\n        let remainingTime = this._adsManager.getRemainingTime();\n        let duration = this._adsManager.getCurrentAd().getDuration();\n        let currentTime = duration - remainingTime;\n        if (Utils.Number.isNumber(duration) && Utils.Number.isNumber(currentTime)) {\n          this.dispatchEvent(this.player.Event.AD_PROGRESS, {\n            adProgress: {\n              currentTime: currentTime,\n              duration: duration\n            }\n          });\n        }\n      }\n    }, 300);\n  }\n\n  /**\n   * Stops ads interval timer.\n   * @private\n   * @returns {void}\n   */\n  _stopAdInterval(): void {\n    if (this._intervalTimer) {\n      clearInterval(this._intervalTimer);\n      this._intervalTimer = null;\n    }\n  }\n\n  /**\n   * Resolves the next promise to let the next handler in the middleware chain start.\n   * @private\n   * @returns {void}\n   */\n  _resolveNextPromise(): void {\n    if (this._nextPromise) {\n      this._nextPromise.resolve();\n      this._nextPromise = null;\n    }\n  }\n\n  /**\n   * Toggle play/pause when click on the ads container.\n   * Relevant only for overlay ads.\n   * @param {boolean} enable - Whether to add or remove the listener.\n   * @private\n   * @returns {void}\n   */\n  _setTogglePlayPauseOnAdsContainerEnabled(enable: boolean): void {\n    if (this._adsContainerDiv && this._togglePlayPauseOnAdsContainerCallback) {\n      if (enable) {\n        this._adsContainerDiv.addEventListener(\"click\", this._togglePlayPauseOnAdsContainerCallback);\n      } else {\n        this._adsContainerDiv.removeEventListener(\"click\", this._togglePlayPauseOnAdsContainerCallback);\n      }\n    }\n  }\n\n  /**\n   * On ads container click handler.\n   * @private\n   * @returns {void}\n   */\n  _onAdsContainerClicked(): void {\n    this.player.paused ? this.player.play() : this.player.pause();\n  }\n\n  /**\n   * Displays companion ads using the Ad API.\n   * @private\n   * @returns {void}\n   */\n  _maybeDisplayCompanionAds(): void {\n    if (this.config.companions && !window.googletag) {\n      let companionsIds = Object.keys(this.config.companions);\n      for (let i = 0; i < companionsIds.length; i++) {\n        let id = companionsIds[i];\n        let width = this.config.companions[id].width;\n        let height = this.config.companions[id].height;\n        let sizeCriteria = this.config.companions[id].sizeCriteria || '';\n        let companionAds = [];\n        try {\n          let selectionCriteria = new this._sdk.CompanionAdSelectionSettings();\n          selectionCriteria.resourceType = this._sdk.CompanionAdSelectionSettings.ResourceType.ALL;\n          selectionCriteria.creativeType = this._sdk.CompanionAdSelectionSettings.CreativeType.ALL;\n          switch (sizeCriteria.toLowerCase()) {\n            case 'selectnearmatch':\n              selectionCriteria.sizeCriteria = this._sdk.CompanionAdSelectionSettings.SizeCriteria.SELECT_NEAR_MATCH;\n              break;\n            case 'ignore':\n              selectionCriteria.sizeCriteria = this._sdk.CompanionAdSelectionSettings.SizeCriteria.IGNORE;\n              break;\n            case 'selectexactmatch':\n            default:\n              selectionCriteria.sizeCriteria = this._sdk.CompanionAdSelectionSettings.SizeCriteria.SELECT_EXACT_MATCH;\n              break;\n          }\n          companionAds = this._currentAd.getCompanionAds(width, height, selectionCriteria);\n          if (companionAds.length > 0) {\n            let companionAd = companionAds[0];\n            let content = companionAd.getContent();\n            let el = Utils.Dom.getElementById(id);\n            if (el) {\n              el.innerHTML = content;\n            }\n          }\n        } catch (e) {\n          this.logger.error(e);\n        }\n      }\n    }\n  }\n}\n\nregisterPlugin(pluginName, Ima);\n\n\n\n// WEBPACK FOOTER //\n// ./ima.js","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"playkit-js\",\"commonjs2\":\"playkit-js\",\"amd\":\"playkit-js\",\"root\":\"Playkit\"}\n// module id = 2\n// module chunks = 0","// @flow\nimport {BaseMiddleware} from 'playkit-js'\nimport Ima from './ima'\nimport State from './state'\n\n/**\n * Middleware implementation for ima plugin.\n * @classdesc\n */\nexport default class ImaMiddleware extends BaseMiddleware {\n  /**\n   * The id of the ima middleware.\n   * @type {string}\n   * @public\n   */\n  id: string = \"ImaMiddleware\";\n  /**\n   * Whether the player has been loaded.\n   * @member\n   * @private\n   */\n  _isPlayerLoaded: boolean;\n  /**\n   * The plugin context.\n   * @member\n   * @private\n   */\n  _context: Ima;\n\n  /**\n   * @constructor\n   * @param {Ima} context - The ima plugin context.\n   */\n  constructor(context: Ima) {\n    super();\n    this._context = context;\n    context.player.addEventListener(context.player.Event.CHANGE_SOURCE_STARTED, () => this._isPlayerLoaded = false);\n  }\n\n  /**\n   * Play middleware handler.\n   * @param {Function} next - The next play handler in the middleware chain.\n   * @returns {void}\n   */\n  play(next: Function): void {\n    if (!this._isPlayerLoaded) {\n      this._context.player.load();\n      this._isPlayerLoaded = true;\n      this._context.logger.debug(\"Player loaded\");\n    }\n    this._context.loadPromise.then(() => {\n      let sm = this._context.getStateMachine();\n      switch (sm.state) {\n        case State.LOADED: {\n          const initialUserAction = this._context.initialUserAction();\n          if (initialUserAction) {\n            initialUserAction.then(() => {\n              this.callNext(next);\n            });\n          } else {\n            this.callNext(next);\n          }\n          break;\n        }\n        case State.PAUSED: {\n          const resumeAd = this._context.resumeAd();\n          if (resumeAd) {\n            resumeAd.then(() => {\n              this.callNext(next);\n            });\n          } else {\n            this.callNext(next);\n          }\n          break;\n        }\n        default: {\n          this.callNext(next);\n          break;\n        }\n      }\n    }).catch((e) => {\n      this._context.destroy();\n      this._context.logger.error(e);\n      this.callNext(next);\n    });\n  }\n\n  /**\n   * Pause middleware handler.\n   * @param {Function} next - The next pause handler in the middleware chain.\n   * @returns {void}\n   */\n  pause(next: Function): void {\n    let sm = this._context.getStateMachine();\n    switch (sm.state) {\n      case State.PLAYING: {\n        this._context.pauseAd();\n        break;\n      }\n      default: {\n        this.callNext(next);\n        break;\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./ima-middleware.js","// @flow\nimport StateMachine from 'javascript-state-machine'\nimport StateMachineHistory from 'javascript-state-machine/lib/history'\nimport State from './state'\n\n/**\n * Finite state machine for ima plugin.\n * @classdesc\n */\nexport default class ImaStateMachine {\n  /**\n   * @constructor\n   * @param {any} context - The plugin context.\n   */\n  constructor(context: any) {\n    return new StateMachine({\n      init: State.LOADING,\n      transitions: [\n        {\n          name: 'loaded',\n          from: [State.LOADING, State.LOADED, State.IDLE, State.PAUSED, State.PLAYING, State.DONE],\n          to: State.LOADED\n        },\n        {\n          name: context.player.Event.AD_STARTED,\n          from: [State.LOADED, State.IDLE, State.PAUSED],\n          to: (adEvent: any): string => {\n            let ad = adEvent.getAd();\n            if (!ad.isLinear()) {\n              return State.IDLE;\n            }\n            return State.PLAYING;\n          }\n        },\n        {\n          name: context.player.Event.AD_RESUMED,\n          from: State.PAUSED,\n          to: State.PLAYING\n        },\n        {\n          name: context.player.Event.AD_PAUSED,\n          from: State.PLAYING,\n          to: State.PAUSED\n        },\n        {\n          name: context.player.Event.AD_SKIPPED,\n          from: [State.PLAYING, State.PAUSED],\n          to: State.IDLE\n        },\n        {\n          name: context.player.Event.AD_COMPLETED,\n          from: State.PLAYING,\n          to: State.IDLE\n        },\n        {\n          name: context.player.Event.ALL_ADS_COMPLETED,\n          from: State.IDLE,\n          to: State.DONE\n        },\n        {\n          name: context.player.Event.AD_BREAK_END,\n          from: [State.IDLE, State.LOADED],\n          to: State.IDLE\n        },\n        {\n          name: context.player.Event.AD_ERROR,\n          from: [State.LOADED, State.PLAYING, State.PAUSED, State.LOADING],\n          to: State.IDLE\n        },\n        {\n          name: context.player.Event.AD_LOADED,\n          from: [State.IDLE, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_FIRST_QUARTILE,\n          from: State.PLAYING\n        },\n        {\n          name: context.player.Event.AD_BREAK_START,\n          from: [State.IDLE, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_MIDPOINT,\n          from: State.PLAYING\n        },\n        {\n          name: context.player.Event.AD_THIRD_QUARTILE,\n          from: State.PLAYING\n        },\n        {\n          name: context.player.Event.USER_CLOSED_AD,\n          from: [State.IDLE, State.PLAYING, State.PAUSED]\n        },\n        {\n          name: context.player.Event.AD_VOLUME_CHANGED,\n          from: [State.PLAYING, State.PAUSED, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_MUTED,\n          from: [State.PLAYING, State.PAUSED, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_CLICKED,\n          from: [State.PLAYING, State.PAUSED, State.IDLE]\n        },\n        {\n          name: 'goto', from: '*', to: s => s\n        }\n      ],\n      methods: {\n        onAdloaded: onAdLoaded.bind(context),\n        onAdstarted: onAdStarted.bind(context),\n        onAdpaused: onAdPaused.bind(context),\n        onAdresumed: onAdEvent.bind(context),\n        onAdclicked: onAdClicked.bind(context),\n        onAdskipped: onAdSkipped.bind(context),\n        onAdcompleted: onAdCompleted.bind(context),\n        onAlladscompleted: onAllAdsCompleted.bind(context),\n        onAdbreakstart: onAdBreakStart.bind(context),\n        onAdbreakend: onAdBreakEnd.bind(context),\n        onAdfirstquartile: onAdEvent.bind(context),\n        onAdmidpoint: onAdEvent.bind(context),\n        onAdthirdquartile: onAdEvent.bind(context),\n        onAderror: onAdError.bind(context),\n        onUserclosedad: onAdEvent.bind(context),\n        onAdvolumechanged: onAdEvent.bind(context),\n        onAdmuted: onAdEvent.bind(context),\n        onEnterState: onEnterState.bind(context),\n      },\n      plugins: [\n        new StateMachineHistory()\n      ]\n    });\n  }\n}\n\n/**\n * LOADED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdLoaded(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.dispatchEvent(options.transition, normalizeAdEvent(adEvent));\n}\n\n/**\n * STARTED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdStarted(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this._currentAd = adEvent.getAd();\n  this._resizeAd();\n  this._showAdsContainer();\n  this._maybeDisplayCompanionAds();\n  if (!this._currentAd.isLinear()) {\n    this._setContentPlayheadTrackerEventsEnabled(true);\n    this._setVideoEndedCallbackEnabled(true);\n    this._togglePlayPauseOnAdsContainerCallback = this._onAdsContainerClicked.bind(this);\n    this._setTogglePlayPauseOnAdsContainerEnabled(true);\n    if (this._nextPromise) {\n      this._resolveNextPromise();\n    } else {\n      this.player.play();\n    }\n  } else {\n    this._setContentPlayheadTrackerEventsEnabled(false);\n    this._startAdInterval();\n  }\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * CLICKED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdClicked(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  if (this._currentAd.isLinear()) {\n    if (this._stateMachine.is(State.PLAYING)) {\n      this.pauseAd();\n    } else if (this._stateMachine.is(State.PAUSED)) {\n      this.resumeAd();\n    }\n  } else {\n    if (!this.player.paused) {\n      this.player.pause();\n    }\n  }\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * PAUSED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdPaused(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * COMPLETE event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdCompleted(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  if (this._currentAd.isLinear()) {\n    this._stopAdInterval();\n  }\n  this._currentAd = null;\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * ALL_ADS_COMPLETED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAllAdsCompleted(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  onAdBreakEnd.call(this, options, adEvent);\n  if (this._adsManager.isCustomPlaybackUsed() && this._contentComplete) {\n    this.player.getVideoElement().src = this._contentSrc;\n  }\n  this.destroy();\n}\n\n/**\n * CONTENT_PAUSED_REQUESTED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdBreakStart(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.player.pause();\n  this._setVideoEndedCallbackEnabled(false);\n  this._maybeSaveVideoCurrentTime();\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * CONTENT_RESUMED_REQUESTED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdBreakEnd(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this._setVideoEndedCallbackEnabled(true);\n  this._setContentPlayheadTrackerEventsEnabled(true);\n  if (!this._contentComplete) {\n    this._hideAdsContainer();\n    this._maybeSetVideoCurrentTime();\n    if (this._nextPromise) {\n      this._resolveNextPromise();\n    } else {\n      this.player.play();\n    }\n  }\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * ERROR event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdError(options: Object, adEvent: any): void {\n  if (adEvent.type === \"adError\") {\n    this.logger.debug(adEvent.type.toUpperCase());\n    let adError = adEvent.getError();\n    if (this.loadPromise) {\n      this.loadPromise.reject(adError);\n    }\n    if (this._nextPromise) {\n      this._nextPromise.reject(adError);\n    }\n    this.dispatchEvent(options.transition, normalizeAdError(adError, true));\n  } else {\n    this.logger.debug(adEvent.type.toUpperCase());\n    let adData = adEvent.getAdData();\n    let adError = adData.adError;\n    if (adData.adError) {\n      this.logger.error('Non-fatal error occurred: ' + adError.getMessage());\n      this.dispatchEvent(this.player.Event.AD_ERROR, normalizeAdError(adError, false));\n    }\n  }\n}\n\n/**\n * SKIPPED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdSkipped(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this._stopAdInterval();\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * General event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n */\nfunction onAdEvent(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * Enter state handler.\n * @param {Object} options - fsm event data.\n * @returns {void}\n */\nfunction onEnterState(options: Object): void {\n  if (options.from !== options.to) {\n    this.logger.debug(\"Change state: \" + options.from + \" => \" + options.to);\n  }\n}\n\n/**\n * Normalize the ima ad error object.\n * @param {any} adError - The ima ad error object.\n * @param {boolean} fatal - Whether the error is fatal.\n * @returns {Object} - The normalized ad error object.\n */\nfunction normalizeAdError(adError: any, fatal: boolean): Object {\n  return {\n    fatal: fatal,\n    error: {\n      code: adError.getErrorCode(),\n      message: adError.getMessage()\n    }\n  };\n}\n\n/**\n * Normalize the ima ad event object.\n * @param {any} adEvent - The ima ad error object.\n * @returns {Object} - The normalized ad event object.\n */\nfunction normalizeAdEvent(adEvent: any): Object {\n  return {\n    ad: adEvent.getAd(),\n    extraAdData: adEvent.getAdData()\n  };\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./ima-state-machine.js","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"StateMachine\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"StateMachine\"] = factory();\n\telse\n\t\troot[\"StateMachine\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function(target, sources) {\n  var n, source, key;\n  for(n = 1 ; n < arguments.length ; n++) {\n    source = arguments[n];\n    for(key in source) {\n      if (source.hasOwnProperty(key))\n        target[key] = source[key];\n    }\n  }\n  return target;\n}\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nvar mixin = __webpack_require__(0);\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = {\n\n  build: function(target, config) {\n    var n, max, plugin, plugins = config.plugins;\n    for(n = 0, max = plugins.length ; n < max ; n++) {\n      plugin = plugins[n];\n      if (plugin.methods)\n        mixin(target, plugin.methods);\n      if (plugin.properties)\n        Object.defineProperties(target, plugin.properties);\n    }\n  },\n\n  hook: function(fsm, name, additional) {\n    var n, max, method, plugin,\n        plugins = fsm.config.plugins,\n        args    = [fsm.context];\n\n    if (additional)\n      args = args.concat(additional)\n\n    for(n = 0, max = plugins.length ; n < max ; n++) {\n      plugin = plugins[n]\n      method = plugins[n][name]\n      if (method)\n        method.apply(plugin, args);\n    }\n  }\n\n}\n\n//-------------------------------------------------------------------------------------------------\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nfunction camelize(label) {\n\n  if (label.length === 0)\n    return label;\n\n  var n, result, word, words = label.split(/[_-]/);\n\n  // single word with first character already lowercase, return untouched\n  if ((words.length === 1) && (words[0][0].toLowerCase() === words[0][0]))\n    return label;\n\n  result = words[0].toLowerCase();\n  for(n = 1 ; n < words.length ; n++) {\n    result = result + words[n].charAt(0).toUpperCase() + words[n].substring(1).toLowerCase();\n  }\n\n  return result;\n}\n\n//-------------------------------------------------------------------------------------------------\n\ncamelize.prepended = function(prepend, label) {\n  label = camelize(label);\n  return prepend + label[0].toUpperCase() + label.substring(1);\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = camelize;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nvar mixin    = __webpack_require__(0),\n    camelize = __webpack_require__(2);\n\n//-------------------------------------------------------------------------------------------------\n\nfunction Config(options, StateMachine) {\n\n  options = options || {};\n\n  this.options     = options; // preserving original options can be useful (e.g visualize plugin)\n  this.defaults    = StateMachine.defaults;\n  this.states      = [];\n  this.transitions = [];\n  this.map         = {};\n  this.lifecycle   = this.configureLifecycle();\n  this.init        = this.configureInitTransition(options.init);\n  this.data        = this.configureData(options.data);\n  this.methods     = this.configureMethods(options.methods);\n\n  this.map[this.defaults.wildcard] = {};\n\n  this.configureTransitions(options.transitions || []);\n\n  this.plugins = this.configurePlugins(options.plugins, StateMachine.plugin);\n\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmixin(Config.prototype, {\n\n  addState: function(name) {\n    if (!this.map[name]) {\n      this.states.push(name);\n      this.addStateLifecycleNames(name);\n      this.map[name] = {};\n    }\n  },\n\n  addStateLifecycleNames: function(name) {\n    this.lifecycle.onEnter[name] = camelize.prepended('onEnter', name);\n    this.lifecycle.onLeave[name] = camelize.prepended('onLeave', name);\n    this.lifecycle.on[name]      = camelize.prepended('on',      name);\n  },\n\n  addTransition: function(name) {\n    if (this.transitions.indexOf(name) < 0) {\n      this.transitions.push(name);\n      this.addTransitionLifecycleNames(name);\n    }\n  },\n\n  addTransitionLifecycleNames: function(name) {\n    this.lifecycle.onBefore[name] = camelize.prepended('onBefore', name);\n    this.lifecycle.onAfter[name]  = camelize.prepended('onAfter',  name);\n    this.lifecycle.on[name]       = camelize.prepended('on',       name);\n  },\n\n  mapTransition: function(transition) {\n    var name = transition.name,\n        from = transition.from,\n        to   = transition.to;\n    this.addState(from);\n    if (typeof to !== 'function')\n      this.addState(to);\n    this.addTransition(name);\n    this.map[from][name] = transition;\n    return transition;\n  },\n\n  configureLifecycle: function() {\n    return {\n      onBefore: { transition: 'onBeforeTransition' },\n      onAfter:  { transition: 'onAfterTransition'  },\n      onEnter:  { state:      'onEnterState'       },\n      onLeave:  { state:      'onLeaveState'       },\n      on:       { transition: 'onTransition'       }\n    };\n  },\n\n  configureInitTransition: function(init) {\n    if (typeof init === 'string') {\n      return this.mapTransition(mixin({}, this.defaults.init, { to: init, active: true }));\n    }\n    else if (typeof init === 'object') {\n      return this.mapTransition(mixin({}, this.defaults.init, init, { active: true }));\n    }\n    else {\n      this.addState(this.defaults.init.from);\n      return this.defaults.init;\n    }\n  },\n\n  configureData: function(data) {\n    if (typeof data === 'function')\n      return data;\n    else if (typeof data === 'object')\n      return function() { return data; }\n    else\n      return function() { return {};  }\n  },\n\n  configureMethods: function(methods) {\n    return methods || {};\n  },\n\n  configurePlugins: function(plugins, builtin) {\n    plugins = plugins || [];\n    var n, max, plugin;\n    for(n = 0, max = plugins.length ; n < max ; n++) {\n      plugin = plugins[n];\n      if (typeof plugin === 'function')\n        plugins[n] = plugin = plugin()\n      if (plugin.configure)\n        plugin.configure(this);\n    }\n    return plugins\n  },\n\n  configureTransitions: function(transitions) {\n    var i, n, transition, from, to, wildcard = this.defaults.wildcard;\n    for(n = 0 ; n < transitions.length ; n++) {\n      transition = transitions[n];\n      from  = Array.isArray(transition.from) ? transition.from : [transition.from || wildcard]\n      to    = transition.to || wildcard;\n      for(i = 0 ; i < from.length ; i++) {\n        this.mapTransition({ name: transition.name, from: from[i], to: to });\n      }\n    }\n  },\n\n  transitionFor: function(state, transition) {\n    var wildcard = this.defaults.wildcard;\n    return this.map[state][transition] ||\n           this.map[wildcard][transition];\n  },\n\n  transitionsFor: function(state) {\n    var wildcard = this.defaults.wildcard;\n    return Object.keys(this.map[state]).concat(Object.keys(this.map[wildcard]));\n  },\n\n  allStates: function() {\n    return this.states;\n  },\n\n  allTransitions: function() {\n    return this.transitions;\n  }\n\n});\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = Config;\n\n//-------------------------------------------------------------------------------------------------\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\nvar mixin      = __webpack_require__(0),\n    Exception  = __webpack_require__(6),\n    plugin     = __webpack_require__(1),\n    UNOBSERVED = [ null, [] ];\n\n//-------------------------------------------------------------------------------------------------\n\nfunction JSM(context, config) {\n  this.context   = context;\n  this.config    = config;\n  this.state     = config.init.from;\n  this.observers = [context];\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmixin(JSM.prototype, {\n\n  init: function(args) {\n    mixin(this.context, this.config.data.apply(this.context, args));\n    plugin.hook(this, 'init');\n    if (this.config.init.active)\n      return this.fire(this.config.init.name, []);\n  },\n\n  is: function(state) {\n    return Array.isArray(state) ? (state.indexOf(this.state) >= 0) : (this.state === state);\n  },\n\n  isPending: function() {\n    return this.pending;\n  },\n\n  can: function(transition) {\n    return !this.isPending() && !!this.seek(transition);\n  },\n\n  cannot: function(transition) {\n    return !this.can(transition);\n  },\n\n  allStates: function() {\n    return this.config.allStates();\n  },\n\n  allTransitions: function() {\n    return this.config.allTransitions();\n  },\n\n  transitions: function() {\n    return this.config.transitionsFor(this.state);\n  },\n\n  seek: function(transition, args) {\n    var wildcard = this.config.defaults.wildcard,\n        entry    = this.config.transitionFor(this.state, transition),\n        to       = entry && entry.to;\n    if (typeof to === 'function')\n      return to.apply(this.context, args);\n    else if (to === wildcard)\n      return this.state\n    else\n      return to\n  },\n\n  fire: function(transition, args) {\n    return this.transit(transition, this.state, this.seek(transition, args), args);\n  },\n\n  transit: function(transition, from, to, args) {\n\n    var lifecycle = this.config.lifecycle,\n        changed   = this.config.options.observeUnchangedState || (from !== to);\n\n    if (!to)\n      return this.context.onInvalidTransition(transition, from, to);\n\n    if (this.isPending())\n      return this.context.onPendingTransition(transition, from, to);\n\n    this.config.addState(to);  // might need to add this state if it's unknown (e.g. conditional transition or goto)\n\n    this.beginTransit();\n\n    args.unshift({             // this context will be passed to each lifecycle event observer\n      transition: transition,\n      from:       from,\n      to:         to,\n      fsm:        this.context\n    });\n\n    return this.observeEvents([\n                this.observersForEvent(lifecycle.onBefore.transition),\n                this.observersForEvent(lifecycle.onBefore[transition]),\n      changed ? this.observersForEvent(lifecycle.onLeave.state) : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.onLeave[from]) : UNOBSERVED,\n                this.observersForEvent(lifecycle.on.transition),\n      changed ? [ 'doTransit', [ this ] ]                       : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.onEnter.state) : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.onEnter[to])   : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.on[to])        : UNOBSERVED,\n                this.observersForEvent(lifecycle.onAfter.transition),\n                this.observersForEvent(lifecycle.onAfter[transition]),\n                this.observersForEvent(lifecycle.on[transition])\n    ], args);\n  },\n\n  beginTransit: function()          { this.pending = true;                 },\n  endTransit:   function(result)    { this.pending = false; return result; },\n  failTransit:  function(result)    { this.pending = false; throw result;  },\n  doTransit:    function(lifecycle) { this.state = lifecycle.to;           },\n\n  observe: function(args) {\n    if (args.length === 2) {\n      var observer = {};\n      observer[args[0]] = args[1];\n      this.observers.push(observer);\n    }\n    else {\n      this.observers.push(args[0]);\n    }\n  },\n\n  observersForEvent: function(event) { // TODO: this could be cached\n    var n = 0, max = this.observers.length, observer, result = [];\n    for( ; n < max ; n++) {\n      observer = this.observers[n];\n      if (observer[event])\n        result.push(observer);\n    }\n    return [ event, result, true ]\n  },\n\n  observeEvents: function(events, args, previousEvent, previousResult) {\n    if (events.length === 0) {\n      return this.endTransit(previousResult === undefined ? true : previousResult);\n    }\n\n    var event     = events[0][0],\n        observers = events[0][1],\n        pluggable = events[0][2];\n\n    args[0].event = event;\n    if (event && pluggable && event !== previousEvent)\n      plugin.hook(this, 'lifecycle', args);\n\n    if (observers.length === 0) {\n      events.shift();\n      return this.observeEvents(events, args, event, previousResult);\n    }\n    else {\n      var observer = observers.shift(),\n          result = observer[event].apply(observer, args);\n      if (result && typeof result.then === 'function') {\n        return result.then(this.observeEvents.bind(this, events, args, event))\n                     .catch(this.failTransit.bind(this))\n      }\n      else if (result === false) {\n        return this.endTransit(false);\n      }\n      else {\n        return this.observeEvents(events, args, event, result);\n      }\n    }\n  },\n\n  onInvalidTransition: function(transition, from, to) {\n    throw new Exception(\"transition is invalid in current state\", transition, from, to, this.state);\n  },\n\n  onPendingTransition: function(transition, from, to) {\n    throw new Exception(\"transition is invalid while previous transition is still in progress\", transition, from, to, this.state);\n  }\n\n});\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = JSM;\n\n//-------------------------------------------------------------------------------------------------\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-----------------------------------------------------------------------------------------------\n\nvar mixin    = __webpack_require__(0),\n    camelize = __webpack_require__(2),\n    plugin   = __webpack_require__(1),\n    Config   = __webpack_require__(3),\n    JSM      = __webpack_require__(4);\n\n//-----------------------------------------------------------------------------------------------\n\nvar PublicMethods = {\n  is:                  function(state)       { return this._fsm.is(state)                                     },\n  can:                 function(transition)  { return this._fsm.can(transition)                               },\n  cannot:              function(transition)  { return this._fsm.cannot(transition)                            },\n  observe:             function()            { return this._fsm.observe(arguments)                            },\n  transitions:         function()            { return this._fsm.transitions()                                 },\n  allTransitions:      function()            { return this._fsm.allTransitions()                              },\n  allStates:           function()            { return this._fsm.allStates()                                   },\n  onInvalidTransition: function(t, from, to) { return this._fsm.onInvalidTransition(t, from, to)              },\n  onPendingTransition: function(t, from, to) { return this._fsm.onPendingTransition(t, from, to)              },\n}\n\nvar PublicProperties = {\n  state: {\n    configurable: false,\n    enumerable:   true,\n    get: function() {\n      return this._fsm.state;\n    },\n    set: function(state) {\n      throw Error('use transitions to change state')\n    }\n  }\n}\n\n//-----------------------------------------------------------------------------------------------\n\nfunction StateMachine(options) {\n  return apply(this || {}, options);\n}\n\nfunction factory() {\n  var cstor, options;\n  if (typeof arguments[0] === 'function') {\n    cstor   = arguments[0];\n    options = arguments[1] || {};\n  }\n  else {\n    cstor   = function() { this._fsm.apply(this, arguments) };\n    options = arguments[0] || {};\n  }\n  var config = new Config(options, StateMachine);\n  build(cstor.prototype, config);\n  cstor.prototype._fsm.config = config; // convenience access to shared config without needing an instance\n  return cstor;\n}\n\n//-------------------------------------------------------------------------------------------------\n\nfunction apply(instance, options) {\n  var config = new Config(options, StateMachine);\n  build(instance, config);\n  instance._fsm();\n  return instance;\n}\n\nfunction build(target, config) {\n  if ((typeof target !== 'object') || Array.isArray(target))\n    throw Error('StateMachine can only be applied to objects');\n  plugin.build(target, config);\n  Object.defineProperties(target, PublicProperties);\n  mixin(target, PublicMethods);\n  mixin(target, config.methods);\n  config.allTransitions().forEach(function(transition) {\n    target[camelize(transition)] = function() {\n      return this._fsm.fire(transition, [].slice.call(arguments))\n    }\n  });\n  target._fsm = function() {\n    this._fsm = new JSM(this, config);\n    this._fsm.init(arguments);\n  }\n}\n\n//-----------------------------------------------------------------------------------------------\n\nStateMachine.version  = '3.0.1';\nStateMachine.factory  = factory;\nStateMachine.apply    = apply;\nStateMachine.defaults = {\n  wildcard: '*',\n  init: {\n    name: 'init',\n    from: 'none'\n  }\n}\n\n//===============================================================================================\n\nmodule.exports = StateMachine;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function(message, transition, from, to, current) {\n  this.message    = message;\n  this.transition = transition;\n  this.from       = from;\n  this.to         = to;\n  this.current    = current;\n}\n\n\n/***/ })\n/******/ ]);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/javascript-state-machine/lib/state-machine.js\n// module id = 5\n// module chunks = 0","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"StateMachineHistory\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"StateMachineHistory\"] = factory();\n\telse\n\t\troot[\"StateMachineHistory\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nfunction camelize(label) {\n\n  if (label.length === 0)\n    return label;\n\n  var n, result, word, words = label.split(/[_-]/);\n\n  // single word with first character already lowercase, return untouched\n  if ((words.length === 1) && (words[0][0].toLowerCase() === words[0][0]))\n    return label;\n\n  result = words[0].toLowerCase();\n  for(n = 1 ; n < words.length ; n++) {\n    result = result + words[n].charAt(0).toUpperCase() + words[n].substring(1).toLowerCase();\n  }\n\n  return result;\n}\n\n//-------------------------------------------------------------------------------------------------\n\ncamelize.prepended = function(prepend, label) {\n  label = camelize(label);\n  return prepend + label[0].toUpperCase() + label.substring(1);\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = camelize;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nvar camelize = __webpack_require__(0);\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = function(options) { options = options || {};\n\n  var past       = camelize(options.name || options.past   || 'history'),\n      future     = camelize(                options.future || 'future'),\n      clear      = camelize.prepended('clear', past),\n      back       = camelize.prepended(past,   'back'),\n      forward    = camelize.prepended(past,   'forward'),\n      canBack    = camelize.prepended('can',   back),\n      canForward = camelize.prepended('can',   forward),\n      max        = options.max;\n\n  var plugin = {\n\n    configure: function(config) {\n      config.addTransitionLifecycleNames(back);\n      config.addTransitionLifecycleNames(forward);\n    },\n\n    init: function(instance) {\n      instance[past]   = [];\n      instance[future] = [];\n    },\n\n    lifecycle: function(instance, lifecycle) {\n      if (lifecycle.event === 'onEnterState') {\n        instance[past].push(lifecycle.to);\n        if (max && instance[past].length > max)\n          instance[past].shift();\n        if (lifecycle.transition !== back && lifecycle.transition !== forward)\n          instance[future].length = 0;\n      }\n    },\n\n    methods:    {},\n    properties: {}\n\n  }\n\n  plugin.methods[clear] = function() {\n    this[past].length = 0\n    this[future].length = 0\n  }\n\n  plugin.properties[canBack] = {\n    get: function() {\n      return this[past].length > 1\n    }\n  }\n\n  plugin.properties[canForward] = {\n    get: function() {\n      return this[future].length > 0\n    }\n  }\n\n  plugin.methods[back] = function() {\n    if (!this[canBack])\n      throw Error('no history');\n    var from = this[past].pop(),\n        to   = this[past].pop();\n    this[future].push(from);\n    this._fsm.transit(back, from, to, []);\n  }\n\n  plugin.methods[forward] = function() {\n    if (!this[canForward])\n      throw Error('no history');\n    var from = this.state,\n        to = this[future].pop();\n    this._fsm.transit(forward, from, to, []);\n  }\n\n  return plugin;\n\n}\n\n\n/***/ })\n/******/ ]);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/javascript-state-machine/lib/history.js\n// module id = 6\n// module chunks = 0"],"sourceRoot":""}